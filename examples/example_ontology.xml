<?xml version="1.0" encoding="UTF-8"?>
<Ontology>
    <Class id="1" name="Mission">
        <description>Operación militar de alto nivel en el ciberespacio</description>
        <Attribute name="mission_id" type="string" cardinality="1"/>
        <Attribute name="name" type="string" cardinality="1"/>
        <Attribute name="priority" type="string" cardinality="1"/>
    </Class>

    <Class id="2" name="Objective">
        <description>Efecto deseado que contribuye al éxito de la misión</description>
        <Attribute name="objective_id" type="string" cardinality="1"/>
        <Attribute name="success_criteria" type="string" cardinality="1"/>
    </Class>

    <Class id="3" name="DecisiveCondition">
        <description>Condición necesaria para lograr un objetivo operativo</description>
        <Attribute name="condition_id" type="string" cardinality="1"/>
        <Attribute name="state_description" type="string" cardinality="1"/>
    </Class>

    <Class id="4" name="Action">
        <description>Actividad táctica ejecutada para generar efectos</description>
        <Attribute name="action_type" type="string" cardinality="1"/> <Attribute name="timestamp" type="datetime" cardinality="1"/>
    </Class>

    <Class id="5" name="Task">
        <description>Unidad mínima de ejecución técnica</description>
        <Attribute name="task_id" type="string" cardinality="1"/>
        <Attribute name="deadline" type="datetime" cardinality="0..1"/>
    </Class>

    <Class id="6" name="Unit">
        <description>Entidad militar orgánica</description>
        <Attribute name="unit_name" type="string" cardinality="1"/>
        <Attribute name="callsign" type="string" cardinality="0..1"/>
    </Class>

    <Class id="7" name="UnitCategory">
        <description>Clasificación funcional (ej. Red Team, Forensic, CPT)</description>
        <Attribute name="cat_name" type="string" cardinality="1"/>
    </Class>

    <Class id="8" name="Echelon">
        <description>Nivel de escalafón (Sección, Compañía, Mando)</description>
        <Attribute name="level" type="string" cardinality="1"/>
    </Class>

    <Class id="9" name="Service">
        <description>Capacidad o rama de servicio ciberdefensivo</description>
        <Attribute name="service_name" type="string" cardinality="1"/>
    </Class>

    <Class id="10" name="Status">
        <description>Estado de salud, alerta o progreso</description>
        <Attribute name="value" type="string" cardinality="1"/> <Attribute name="last_update" type="datetime" cardinality="1"/>
    </Class>

    <Class id="11" name="Infrastructure">
        <description>Entorno físico y lógico de soporte (Redes, Cloud, CPD)</description>
        <Attribute name="infra_id" type="string" cardinality="1"/>
        <Attribute name="location" type="string" cardinality="1"/>
    </Class>

    <Class id="12" name="CyberAsset">
        <description>Dispositivo, servidor o endpoint crítico</description>
        <Attribute name="ip_address" type="string" cardinality="0..1"/>
        <Attribute name="hostname" type="string" cardinality="1"/>
        <Attribute name="criticality" type="integer" cardinality="1"/>
    </Class>

    <Class id="13" name="SecurityNetwork">
        <description>Perímetro o segmento de red con políticas de seguridad</description>
        <Attribute name="vlan_id" type="integer" cardinality="1"/>
        <Attribute name="trust_level" type="string" cardinality="1"/>
    </Class>

    <Class id="14" name="Vulnerability">
        <description>Debilidad técnica explotable</description>
        <Attribute name="cve_id" type="string" cardinality="1"/>
        <Attribute name="cvss" type="float" cardinality="1"/>
    </Class>

    <Class id="15" name="Event">
        <description>Suceso detectado por sensores o logs</description>
        <Attribute name="source_log" type="string" cardinality="1"/>
    </Class>

    <Class id="16" name="Incident">
        <description>Violación confirmada de la seguridad</description>
        <Attribute name="incident_id" type="string" cardinality="1"/>
        <Attribute name="severity" type="string" cardinality="1"/>
    </Class>

    <Class id="17" name="MitreAttack">
        <description>Tácticas y Técnicas Adversarias</description>
        <Attribute name="technique_id" type="string" cardinality="1"/>
    </Class>

    <Class id="18" name="MitreDefend">
        <description>Contramedidas y endurecimiento técnico</description>
        <Attribute name="defend_id" type="string" cardinality="1"/>
    </Class>

    <Class id="19" name="MitreEngage">
        <description>Acciones de engaño y contacto con el adversario</description>
        <Attribute name="engage_id" type="string" cardinality="1"/>
    </Class>

    <Relation name="assesses_objective" source="Mission" target="Objective" type="association" source_cardinality="1" target_cardinality="1..n"/>
    <Relation name="assesses_condition" source="Objective" target="DecisiveCondition" type="association" source_cardinality="1" target_cardinality="1..n"/>
    <Relation name="assesses_action" source="DecisiveCondition" target="Action" type="association" source_cardinality="1" target_cardinality="1..n"/>
    
    <Relation name="consists_of" source="Action" target="Task" type="aggregation" source_cardinality="1" target_cardinality="1..n"/>
    <Relation name="assigned_to" source="Task" target="Unit" type="association" source_cardinality="0..n" target_cardinality="1"/>
    <Relation name="task_has_status" source="Task" target="Status" type="association" source_cardinality="1" target_cardinality="1"/>
    <Relation name="unit_has_status" source="Unit" target="Status" type="association" source_cardinality="1" target_cardinality="1"/>
    <Relation name="mission_has_status" source="Mission" target="Status" type="association" source_cardinality="1" target_cardinality="1"/>
    <Relation name="service_has_status" source="Service" target="Status" type="association" source_cardinality="1" target_cardinality="1"/>

    <Relation name="has_category" source="Unit" target="UnitCategory" type="association" source_cardinality="0..n" target_cardinality="1"/>
    <Relation name="has_echelon" source="Unit" target="Echelon" type="association" source_cardinality="0..n" target_cardinality="1"/>

    <Relation name="causes" source="Event" target="Incident" type="association" source_cardinality="1..n" target_cardinality="1"/>
    <Relation name="uses_vulnerability" source="Incident" target="Vulnerability" type="association" source_cardinality="1" target_cardinality="0..n"/>
    <Relation name="involves_incident" source="MitreAttack" target="Incident" type="association" source_cardinality="1" target_cardinality="0..n"/>
    <Relation name="is_covered_by" source="MitreAttack" target="MitreDefend" type="association" source_cardinality="1" target_cardinality="0..n"/>
    <Relation name="is_protected_by" source="MitreAttack" target="MitreEngage" type="association" source_cardinality="1" target_cardinality="0..n"/>

    <Relation name="has_security_network" source="Service" target="SecurityNetwork" type="association" source_cardinality="1" target_cardinality="1..n"/>
    <Relation name="supports_service" source="CyberAsset" target="Service" type="association" source_cardinality="1..n" target_cardinality="1"/>
    <Relation name="affects_asset" source="Vulnerability" target="CyberAsset" type="association" source_cardinality="0..n" target_cardinality="1..n"/>
    
    <Relation name="unit_uses_infra" source="Unit" target="Infrastructure" type="association" source_cardinality="1..n" target_cardinality="1..n"/>
    <Relation name="service_uses_infra" source="Service" target="Infrastructure" type="association" source_cardinality="1..n" target_cardinality="1..n"/>
    <Relation name="task_uses_infra" source="Task" target="Infrastructure" type="association" source_cardinality="1..n" target_cardinality="1..n"/>

</Ontology>